#!/usr/bin/env bash

# Папка со скриптами
SCRIPTS_DIR="$HOME/scripts"

# Имя этого скрипта
THIS_SCRIPT=$(basename "$0")

# Найти все исполняемые файлы, кроме этого скрипта
ALL_SCRIPTS=$(find "$SCRIPTS_DIR/" -maxdepth 1 -type f -executable ! -name "$THIS_SCRIPT")

# Преобразовать список: если имя = rofi-XXX → показать как XXX с большой буквы
MENU_ITEMS=""
for script in $ALL_SCRIPTS; do
  name=$(basename "$script")
  if [[ "$name" == rofi-* ]]; then
    # Убираем префикс и делаем первую букву заглавной
    pretty_name="$(echo "${name#rofi-}" | sed 's/^./\U&/')"
    MENU_ITEMS+="$pretty_name ($name)\n"
  else
    MENU_ITEMS+="$name\n"
  fi
done

# Показать в rofi
CHOICE=$(echo -e "$MENU_ITEMS" | rofi -dmenu -p "Run script:")

# Если пусто — выйти
[ -z "$CHOICE" ] && exit

# Достать реальное имя скрипта из выбора
# Если выбор был Somescript (rofi-somescript) → вернуть rofi-somescript
SCRIPT_NAME=$(echo "$CHOICE" | grep -oP '\(\K[^)]+' || echo "$CHOICE")

# Запустить
"$SCRIPTS_DIR/$SCRIPT_NAME"
